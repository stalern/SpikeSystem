<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/components.css" rel="stylesheet" type="text/css"/>
        <link href="css/login.css" rel="stylesheet" type="text/css"/>
        <script src="js/jquery-1.11.0.min.js" type="text/javascript"></script>
        <title>getOtp</title>
    </head>

    <body class="login">
        <div class="content">
            <h3 class="form-title">获取otp信息</h3>
            <div class="form-group">
                <label class="control-label">邮箱</label>
                <div>
                    <input  class="form-control" type="text" placeholder="邮箱" name="email" id="email"/>
                </div>
            </div>
            <div class="form-actions">
                <button class="btn blue" id="getOtp" type="submit">
                    获取otp
                </button>
            </div>
        </div>

    </body>


    <script>
        jQuery(document).ready(function(){
            // 绑定otp的click时间用于向后端发送获取手机验证码的请求
            $("#getOtp").on("click",function(){
                const email = $("#email").val();
                if(email == null || email === ""){
                    alert("邮箱不能为空");
                    return false;
                }
                $.ajax({
                    type:"GET",
                    url:"http://localhost:8090/user/getOtp/" + email,
                xhrFields:{withCredentials:true},
                success:function(data){
                    if(data.status === "success"){
                        alert("otp已经发送到了您的邮箱上，请注意查收");
                        window.location.href="./register.html";
                    }else{
                        alert("otp发送失败，原因为"+data.data.errMsg);
                    }
                },
                error:function(data){
                    alert("otp发送失败，原因为"+data.responseText);
                }
            });
                return false;
            });
        });


    </script>
</html>